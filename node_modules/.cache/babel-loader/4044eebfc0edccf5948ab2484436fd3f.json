{"ast":null,"code":"import _objectSpread from\"/samba/Journal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/samba/Journal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/samba/Journal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import Swal from'sweetalert2';import{db}from\"../firebase/firebase-config\";import{types}from'../types/types';import{loadNotes}from'../helpers/loadNotes';import{fileUpload}from'../helpers/fileUpload';export var startNewNote=function startNewNote(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch,getState){var uid,newNote,doc;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:uid=getState().auth.uid;newNote={title:'',body:'',date:new Date().getTime()};_context.next=4;return db.collection(\"\".concat(uid,\"/journal/notes\")).add(newNote);case 4:doc=_context.sent;dispatch(activeNote(doc.id,newNote));dispatch(addNewNote(doc.id,newNote));case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();};export var activeNote=function activeNote(id,note){return{type:types.notesActive,payload:_objectSpread({id:id},note)};};export var addNewNote=function addNewNote(id,note){return{type:types.notesAddNew,payload:_objectSpread({id:id},note)};};export var startLoadingNotes=function startLoadingNotes(uid){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var notes;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return loadNotes(uid);case 2:notes=_context2.sent;dispatch(setNotes(notes));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref2.apply(this,arguments);};}();};export var setNotes=function setNotes(notes){return{type:types.notesLoad,payload:notes};};export var startSaveNote=function startSaveNote(note){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch,getState){var uid,noteToFirestore;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:uid=getState().auth.uid;if(!note.url){delete note.url;}noteToFirestore=_objectSpread({},note);delete noteToFirestore.id;_context3.next=6;return db.doc(\"\".concat(uid,\"/journal/notes/\").concat(note.id)).update(noteToFirestore);case 6:dispatch(refreshNote(note.id,noteToFirestore));Swal.fire('saved',note.title,'success');case 8:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x4,_x5){return _ref3.apply(this,arguments);};}();};export var refreshNote=function refreshNote(id,note){return{type:types.notesUpdated,payload:{id:id,note:_objectSpread({id:id},note)}};};export var startUploading=function startUploading(file){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch,getState){var activeNote,fileUrl;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:activeNote=getState().notes.active;Swal.fire({title:'Uploading...',text:'Please wait...',allowOutsideClick:false,didOpen:function didOpen(){Swal.showLoading();}});_context4.next=4;return fileUpload(file);case 4:fileUrl=_context4.sent;activeNote.url=fileUrl;dispatch(startSaveNote(activeNote));Swal.close();case 8:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x6,_x7){return _ref4.apply(this,arguments);};}();};export var startDeleting=function startDeleting(id){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch,getState){var uid;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:uid=getState().auth.uid;_context5.next=3;return db.doc(\"\".concat(uid,\"/journal/notes/\").concat(id)).delete();case 3:dispatch(deleteNote(id));case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x8,_x9){return _ref5.apply(this,arguments);};}();};export var deleteImage=function deleteImage(url){return{type:types.deleteImage,payload:url};};export var deleteNote=function deleteNote(id){return{type:types.notesDelete,payload:id};};export var emptyNotes=function emptyNotes(notes,active){return{type:types.notesLogoutCleaning,payload:{active:active,notes:notes}};};","map":{"version":3,"sources":["/samba/Journal/src/actions/notes.js"],"names":["Swal","db","types","loadNotes","fileUpload","startNewNote","dispatch","getState","uid","auth","newNote","title","body","date","Date","getTime","collection","add","doc","activeNote","id","addNewNote","note","type","notesActive","payload","notesAddNew","startLoadingNotes","notes","setNotes","notesLoad","startSaveNote","url","noteToFirestore","update","refreshNote","fire","notesUpdated","startUploading","file","active","text","allowOutsideClick","didOpen","showLoading","fileUrl","close","startDeleting","delete","deleteNote","deleteImage","notesDelete","emptyNotes","notesLogoutCleaning"],"mappings":"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","sourcesContent":["import Swal from 'sweetalert2'\r\n\r\nimport { db } from \"../firebase/firebase-config\";\r\nimport { types } from '../types/types';\r\nimport { loadNotes } from '../helpers/loadNotes'\r\nimport { fileUpload } from '../helpers/fileUpload';\r\n\r\n\r\n\r\nexport const startNewNote = () => {\r\n    return async (dispatch, getState) => {\r\n\r\n        const {uid} = getState().auth\r\n\r\n        const newNote = {\r\n            title: '',\r\n            body: '',\r\n            date: new Date().getTime()\r\n        }\r\n        \r\n        const doc = await db.collection( `${uid}/journal/notes`).add( newNote) \r\n\r\n        dispatch( activeNote( doc.id, newNote) );\r\n        dispatch( addNewNote( doc.id, newNote) );\r\n    }\r\n}\r\n\r\nexport const activeNote = ( id, note ) => ({\r\n\r\n    type: types.notesActive,\r\n    payload: {\r\n        id,\r\n        ...note\r\n    }\r\n});\r\n\r\nexport const addNewNote = ( id, note ) => ({ \r\n    type: types.notesAddNew,\r\n    payload: {\r\n        id, \r\n        ...note\r\n    }\r\n})\r\n\r\n\r\nexport const startLoadingNotes = ( uid ) => {\r\n    return async ( dispatch ) => {\r\n        const notes = await loadNotes( uid );\r\n        dispatch(setNotes(notes));\r\n        \r\n    }\r\n}\r\n\r\n\r\n\r\nexport const setNotes = ( notes ) => ({\r\n    type: types.notesLoad,\r\n    payload: notes \r\n});\r\n\r\n\r\nexport const startSaveNote = ( note )=> {\r\n    return async(dispatch, getState) => {\r\n        \r\n        const {uid} = getState().auth\r\n        \r\n        if ( !note.url ){\r\n            \r\n            delete note.url;\r\n        }\r\n        \r\n        \r\n        const noteToFirestore =  { ...note };\r\n        delete noteToFirestore.id;\r\n        \r\n        await db.doc(`${uid}/journal/notes/${ note.id }`).update( noteToFirestore );\r\n        \r\n        dispatch( refreshNote(note.id, noteToFirestore) );\r\n        Swal.fire('saved', note.title, 'success')\r\n        \r\n    }\r\n}\r\n\r\nexport const refreshNote = ( id, note ) => ({\r\n    type: types.notesUpdated,\r\n    payload: {\r\n        id, \r\n        note: {\r\n            id,\r\n            ...note\r\n        }\r\n    }\r\n});\r\n\r\nexport const startUploading = (file) => {\r\n    return async( dispatch, getState ) => {\r\n\r\n        const { active:activeNote } = getState().notes;\r\n\r\n        Swal.fire({\r\n            title: 'Uploading...',\r\n            text: 'Please wait...',\r\n            allowOutsideClick: false,\r\n            didOpen: () => {\r\n                Swal.showLoading();\r\n            }\r\n        });\r\n        \r\n        const fileUrl = await fileUpload(file)\r\n\r\n        activeNote.url= fileUrl;\r\n\r\n        dispatch( startSaveNote( activeNote ) )\r\n\r\n        Swal.close();\r\n    }\r\n}\r\n\r\nexport const startDeleting = ( id ) => {\r\n    return async (dispatch, getState) => {\r\n        const uid = getState().auth.uid;\r\n        await db.doc(`${ uid }/journal/notes/${ id }`).delete();\r\n        \r\n        dispatch( deleteNote(id) );\r\n        \r\n    }\r\n}\r\n\r\nexport const deleteImage = (url) => ({\r\n\r\n    type: types.deleteImage,\r\n    payload: url\r\n    \r\n})\r\n\r\nexport const deleteNote = ( id ) => ({\r\n    type: types.notesDelete,\r\n    payload: id,\r\n})\r\n\r\nexport const emptyNotes = (notes, active) => ({\r\n    type: types.notesLogoutCleaning,\r\n    payload: {\r\n        active,\r\n        notes\r\n    }\r\n})"]},"metadata":{},"sourceType":"module"}